# Working with Causal Sets

This guide explains how to create and analyze causal sets using the `CausalSet` class 
## Introduction

A causal set is a discrete structure consisting of a set of elements with a partial order relation that represents causality. In `pycauset`, causal sets are typically generated by "sprinkling" points randomly into a continuous spacetime manifold (like Minkowski space) and inducing the causal order from the manifold's lightcone structure.

## Creating a Causal Set

The primary way to create a causal set is using the `CausalSet` class.

```python
import pycauset

# Create a causal set with 10,000 elements
# By default, this sprinkles into a 2D Minkowski Diamond
c = pycauset.CausalSet(10000)
```

You can also use the alias `Causet`:

```python
c = pycauset.Causet(10000)
```

### Reproducibility

To ensure your causal set is identical every time you run your code, provide a `seed`:

```python
c = pycauset.Causet(10000, seed=12345)
```

## Accessing the Causal Matrix

The core data of a causal set is its _causal matrix_. In `pycauset`, this is represented as a `TriangularBitMatrix` for efficiency. You can access it via the `.CausalMatrix` property or its alias `.C`.

```python
# Get the causal matrix
M = c.CausalMatrix

# Or using the alias
M = c.C

# M is a pycauset.TriangularBitMatrix
print(M)
```

The matrix $M$ is defined such that $M_{ij} = 1$ if element $i$ is in the causal past of element $j$ ($i \prec j$), and $0$ otherwise. Since the points are sorted by their time coordinate during generation, the matrix is strictly upper triangular.

## What is a CausalSet Instance?

When you create an instance of `CausalSet`, you might wonder what exactly is being stored in memory.

```python
c = pycauset.Causet(1000)
```

The `c` object itself is extremely lightweight. It is essentially a metadata wrapper that holds:
1.  **N**: The number of elements (e.g., 1000).
2.  **Seed**: The random seed used for generation.
3.  **Spacetime**: The definition of the manifold (e.g., "2D Minkowski Diamond").
4.  **Handle to CausalMatrix**: A reference to the `TriangularBitMatrix` object.

**What is NOT stored:**
*   **Coordinates**: The coordinates of the 1000 points are **not** stored in the `c` object. They were generated temporarily to compute the matrix and then discarded.
*   **Full Matrix in RAM**: The `CausalMatrix` is backed by a file on disk. It is not fully loaded into RAM unless you explicitly read all of it.

The "End Product" of the initialization is the **Causal Matrix** stored on disk. The `CausalSet` instance is just your handle to access that matrix and remember how it was created.

## Large Scale Simulations

`pycauset` is designed for large-scale simulations. The `CausalSet` class uses a **stateless sprinkling** technique (see [Stateless Sprinkling](../internals/Stateless Sprinkling.md)) that avoids storing the coordinates of the points. This means you can generate causal sets with billions of elements without running out of RAM, provided you have enough disk space to store the resulting bit matrix.

```python
# Generating a very large causal set (e.g., 1 million elements)
# This is memory-safe!
c_large = pycauset.Causet(1_000_000)

# The matrix is stored on disk, mapped into memory only as needed
M_large = c_large.C
```

## Custom Spacetimes

By default, `CausalSet` uses a 2-dimensional Minkowski Diamond. (Future versions will support custom spacetime manifolds).

```python
# Currently, only the default 2D Minkowski Diamond is fully exposed via the high-level API
# but the architecture supports arbitrary dimensions and metrics.
```
